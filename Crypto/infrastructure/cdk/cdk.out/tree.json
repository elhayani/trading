{"version":"tree-0.1","tree":{"id":"App","path":"","constructInfo":{"fqn":"aws-cdk-lib.App","version":"2.234.1"},"children":{"V4TradingStack":{"id":"V4TradingStack","path":"V4TradingStack","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.234.1"},"children":{"TradingState":{"id":"TradingState","path":"V4TradingStack/TradingState","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.Table","version":"2.234.1","metadata":[]},"children":{"Resource":{"id":"Resource","path":"V4TradingStack/TradingState/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.CfnTable","version":"2.234.1"},"attributes":{"aws:cdk:cloudformation:type":"AWS::DynamoDB::Table","aws:cdk:cloudformation:props":{"attributeDefinitions":[{"attributeName":"trader_id","attributeType":"S"}],"billingMode":"PAY_PER_REQUEST","keySchema":[{"attributeName":"trader_id","keyType":"HASH"}],"pointInTimeRecoverySpecification":{"pointInTimeRecoveryEnabled":true},"tableName":"V4TradingState"}}},"ScalingRole":{"id":"ScalingRole","path":"V4TradingStack/TradingState/ScalingRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.234.1","metadata":[]}}}},"TradeHistory":{"id":"TradeHistory","path":"V4TradingStack/TradeHistory","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.Table","version":"2.234.1","metadata":[]},"children":{"Resource":{"id":"Resource","path":"V4TradingStack/TradeHistory/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.CfnTable","version":"2.234.1"},"attributes":{"aws:cdk:cloudformation:type":"AWS::DynamoDB::Table","aws:cdk:cloudformation:props":{"attributeDefinitions":[{"attributeName":"trade_id","attributeType":"S"},{"attributeName":"timestamp","attributeType":"N"}],"billingMode":"PAY_PER_REQUEST","keySchema":[{"attributeName":"trade_id","keyType":"HASH"},{"attributeName":"timestamp","keyType":"RANGE"}],"pointInTimeRecoverySpecification":{"pointInTimeRecoveryEnabled":true},"tableName":"V4TradeHistory"}}},"ScalingRole":{"id":"ScalingRole","path":"V4TradingStack/TradeHistory/ScalingRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.234.1","metadata":[]}}}},"V4HybridTrader":{"id":"V4HybridTrader","path":"V4TradingStack/V4HybridTrader","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.Function","version":"2.234.1","metadata":[]},"children":{"ServiceRole":{"id":"ServiceRole","path":"V4TradingStack/V4HybridTrader/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.234.1","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"V4TradingStack/V4HybridTrader/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.234.1","metadata":[]}},"Resource":{"id":"Resource","path":"V4TradingStack/V4HybridTrader/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.234.1"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"V4TradingStack/V4HybridTrader/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.234.1","metadata":[]},"children":{"Resource":{"id":"Resource","path":"V4TradingStack/V4HybridTrader/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.234.1"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["dynamodb:BatchGetItem","dynamodb:Query","dynamodb:GetItem","dynamodb:Scan","dynamodb:ConditionCheckItem","dynamodb:BatchWriteItem","dynamodb:PutItem","dynamodb:UpdateItem","dynamodb:DeleteItem","dynamodb:DescribeTable"],"Effect":"Allow","Resource":{"Fn::GetAtt":["TradingStateB112B6FA","Arn"]}},{"Action":["dynamodb:GetRecords","dynamodb:GetShardIterator"],"Effect":"Allow","Resource":{"Fn::GetAtt":["TradingStateB112B6FA","Arn"]}},{"Action":["dynamodb:BatchGetItem","dynamodb:Query","dynamodb:GetItem","dynamodb:Scan","dynamodb:ConditionCheckItem","dynamodb:BatchWriteItem","dynamodb:PutItem","dynamodb:UpdateItem","dynamodb:DeleteItem","dynamodb:DescribeTable"],"Effect":"Allow","Resource":{"Fn::GetAtt":["TradeHistoryE49C44D8","Arn"]}},{"Action":["dynamodb:GetRecords","dynamodb:GetShardIterator"],"Effect":"Allow","Resource":{"Fn::GetAtt":["TradeHistoryE49C44D8","Arn"]}},{"Action":["dynamodb:BatchWriteItem","dynamodb:PutItem","dynamodb:UpdateItem","dynamodb:DeleteItem","dynamodb:DescribeTable"],"Effect":"Allow","Resource":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":dynamodb:us-east-1:946179054632:table/EmpireTradesHistory"]]}},{"Action":["bedrock:InvokeModel","bedrock:InvokeModelWithResponseStream"],"Effect":"Allow","Resource":"arn:aws:bedrock:us-east-1::foundation-model/anthropic.claude-3-haiku-20240307-v1:0"}],"Version":"2012-10-17"},"policyName":"V4HybridTraderServiceRoleDefaultPolicyB6DA87C7","roles":[{"Ref":"V4HybridTraderServiceRoleAB8336FF"}]}}}}}}},"Code":{"id":"Code","path":"V4TradingStack/V4HybridTrader/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.234.1"},"children":{"Stage":{"id":"Stage","path":"V4TradingStack/V4HybridTrader/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.234.1"}},"AssetBucket":{"id":"AssetBucket","path":"V4TradingStack/V4HybridTrader/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.234.1","metadata":[]}}}},"Resource":{"id":"Resource","path":"V4TradingStack/V4HybridTrader/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.234.1"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":"cdk-hnb659fds-assets-946179054632-us-east-1","s3Key":"fda03650be0fd53a8872a6dcc5ac4290f4bd6119f3f494cbc1d352db3d59db90.zip"},"environment":{"variables":{"STATE_TABLE":{"Ref":"TradingStateB112B6FA"},"HISTORY_TABLE":{"Ref":"TradeHistoryE49C44D8"},"TRADING_MODE":"test","CAPITAL":"1000","SYMBOLS":"SOL/USDT","CHECK_INTERVAL":"3600","EXCHANGE":"binance"}},"functionName":"V4HybridLiveTrader","handler":"v4_hybrid_lambda.lambda_handler","layers":["arn:aws:lambda:us-east-1:336392948345:layer:AWSSDKPandas-Python312:8",{"Ref":"V4DependencyLayer97B327D1"}],"memorySize":512,"role":{"Fn::GetAtt":["V4HybridTraderServiceRoleAB8336FF","Arn"]},"runtime":"python3.12","timeout":300}}},"LogRetention":{"id":"LogRetention","path":"V4TradingStack/V4HybridTrader/LogRetention","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.LogRetention","version":"2.234.1"},"children":{"Resource":{"id":"Resource","path":"V4TradingStack/V4HybridTrader/LogRetention/Resource","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.234.1"}}}},"LogGroup":{"id":"LogGroup","path":"V4TradingStack/V4HybridTrader/LogGroup","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.234.1","metadata":[]}}}},"LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a":{"id":"LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a","path":"V4TradingStack/LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a","constructInfo":{"fqn":"constructs.Construct","version":"10.4.4"},"children":{"Code":{"id":"Code","path":"V4TradingStack/LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.234.1"},"children":{"Stage":{"id":"Stage","path":"V4TradingStack/LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.234.1"}},"AssetBucket":{"id":"AssetBucket","path":"V4TradingStack/LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.234.1","metadata":[]}}}},"ServiceRole":{"id":"ServiceRole","path":"V4TradingStack/LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.234.1","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"V4TradingStack/LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.234.1","metadata":[]}},"Resource":{"id":"Resource","path":"V4TradingStack/LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.234.1"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"V4TradingStack/LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.234.1","metadata":[]},"children":{"Resource":{"id":"Resource","path":"V4TradingStack/LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.234.1"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["logs:PutRetentionPolicy","logs:DeleteRetentionPolicy"],"Effect":"Allow","Resource":"*"}],"Version":"2012-10-17"},"policyName":"LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aServiceRoleDefaultPolicyADDA7DEB","roles":[{"Ref":"LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aServiceRole9741ECFB"}]}}}}}}},"Resource":{"id":"Resource","path":"V4TradingStack/LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a/Resource","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.234.1"}}}},"EmpireHistoryTable":{"id":"EmpireHistoryTable","path":"V4TradingStack/EmpireHistoryTable","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.TableBase","version":"2.234.1","metadata":[]}},"AWSPandasLayer":{"id":"AWSPandasLayer","path":"V4TradingStack/AWSPandasLayer","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.234.1","metadata":[]}},"V4DependencyLayer":{"id":"V4DependencyLayer","path":"V4TradingStack/V4DependencyLayer","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.LayerVersion","version":"2.234.1","metadata":[]},"children":{"Code":{"id":"Code","path":"V4TradingStack/V4DependencyLayer/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.234.1"},"children":{"Stage":{"id":"Stage","path":"V4TradingStack/V4DependencyLayer/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.234.1"}},"AssetBucket":{"id":"AssetBucket","path":"V4TradingStack/V4DependencyLayer/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.234.1","metadata":[]}}}},"Resource":{"id":"Resource","path":"V4TradingStack/V4DependencyLayer/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnLayerVersion","version":"2.234.1"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::LayerVersion","aws:cdk:cloudformation:props":{"compatibleRuntimes":["python3.12"],"content":{"s3Bucket":"cdk-hnb659fds-assets-946179054632-us-east-1","s3Key":"36eb6e9f878422742d7b1f0746a6f8a394e7ce82152146ae282449167a0e2296.zip"},"description":"Dependencies: ccxt, requests, ta-lib fallback"}}}}},"V4TradingSchedule":{"id":"V4TradingSchedule","path":"V4TradingStack/V4TradingSchedule","constructInfo":{"fqn":"aws-cdk-lib.aws_events.Rule","version":"2.234.1","metadata":[]},"children":{"Resource":{"id":"Resource","path":"V4TradingStack/V4TradingSchedule/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_events.CfnRule","version":"2.234.1"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Events::Rule","aws:cdk:cloudformation:props":{"description":"Trigger V4 HYBRID trader every hour","name":"V4HybridHourlyCron","scheduleExpression":"cron(0 * ? * * *)","state":"ENABLED","targets":[{"id":"Target0","arn":{"Fn::GetAtt":["V4HybridTraderB2451C29","Arn"]}}]}}},"AllowEventRuleV4TradingStackV4HybridTrader456F1AE4":{"id":"AllowEventRuleV4TradingStackV4HybridTrader456F1AE4","path":"V4TradingStack/V4TradingSchedule/AllowEventRuleV4TradingStackV4HybridTrader456F1AE4","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.234.1"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["V4HybridTraderB2451C29","Arn"]},"principal":"events.amazonaws.com","sourceArn":{"Fn::GetAtt":["V4TradingSchedule326B594A","Arn"]}}}}}},"V4ManualTrigger":{"id":"V4ManualTrigger","path":"V4TradingStack/V4ManualTrigger","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.Function","version":"2.234.1","metadata":[]},"children":{"ServiceRole":{"id":"ServiceRole","path":"V4TradingStack/V4ManualTrigger/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.234.1","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"V4TradingStack/V4ManualTrigger/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.234.1","metadata":[]}},"Resource":{"id":"Resource","path":"V4TradingStack/V4ManualTrigger/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.234.1"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"V4TradingStack/V4ManualTrigger/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.234.1","metadata":[]},"children":{"Resource":{"id":"Resource","path":"V4TradingStack/V4ManualTrigger/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.234.1"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":"lambda:InvokeFunction","Effect":"Allow","Resource":[{"Fn::GetAtt":["V4HybridTraderB2451C29","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["V4HybridTraderB2451C29","Arn"]},":*"]]}]}],"Version":"2012-10-17"},"policyName":"V4ManualTriggerServiceRoleDefaultPolicyBBF3648E","roles":[{"Ref":"V4ManualTriggerServiceRole63E3CB46"}]}}}}}}},"Resource":{"id":"Resource","path":"V4TradingStack/V4ManualTrigger/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.234.1"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"zipFile":{"Fn::Join":["",["\nimport json\nimport boto3\n\nlambda_client = boto3.client('lambda')\n\ndef lambda_handler(event, context):\n    '''Manually trigger V4 trader for testing'''\n    \n    response = lambda_client.invoke(\n        FunctionName='",{"Ref":"V4HybridTraderB2451C29"},"',\n        InvocationType='RequestResponse',\n        Payload=json.dumps({'manual': True})\n    )\n    \n    result = json.loads(response['Payload'].read())\n    \n    return {\n        'statusCode': 200,\n        'body': json.dumps(result)\n    }\n            "]]}},"functionName":"V4ManualTrigger","handler":"index.lambda_handler","role":{"Fn::GetAtt":["V4ManualTriggerServiceRole63E3CB46","Arn"]},"runtime":"python3.12","timeout":30}}}}},"TradingLambdaArn":{"id":"TradingLambdaArn","path":"V4TradingStack/TradingLambdaArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.234.1"}},"StateTableName":{"id":"StateTableName","path":"V4TradingStack/StateTableName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.234.1"}},"HistoryTableName":{"id":"HistoryTableName","path":"V4TradingStack/HistoryTableName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.234.1"}},"ScheduleRuleName":{"id":"ScheduleRuleName","path":"V4TradingStack/ScheduleRuleName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.234.1"}},"ManualTriggerArn":{"id":"ManualTriggerArn","path":"V4TradingStack/ManualTriggerArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.234.1"}},"CDKMetadata":{"id":"CDKMetadata","path":"V4TradingStack/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.4"},"children":{"Default":{"id":"Default","path":"V4TradingStack/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.234.1"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"V4TradingStack/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.234.1"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"V4TradingStack/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.234.1"}}}},"Tree":{"id":"Tree","path":"Tree","constructInfo":{"fqn":"constructs.Construct","version":"10.4.4"}}}}}