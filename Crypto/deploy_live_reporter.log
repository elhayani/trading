======================================================================
üöÄ V4 HYBRID AWS DEPLOYMENT
======================================================================

üìã Step 1: Checking Prerequisites...
----------------------------------------------------------------------
[0;32m‚úÖ AWS CLI[0m
[0;32m‚úÖ CDK[0m
[0;32m‚úÖ AWS Account: 946179054632[0m

üì¶ Step 2: Preparing Lambda Code...
----------------------------------------------------------------------
[0;32m‚úÖ Lambda code ready in Crypto/lambda/v4_trader[0m

üìö Step 2.1: Building Dependency Layer...
----------------------------------------------------------------------
  ‚Üí Installing CCXT & YFinance...
Collecting ccxt
  Using cached ccxt-4.5.36-py2.py3-none-any.whl.metadata (139 kB)
Collecting yfinance
  Using cached yfinance-1.1.0-py2.py3-none-any.whl.metadata (6.1 kB)
Collecting requests
  Using cached requests-2.32.5-py3-none-any.whl.metadata (4.9 kB)
Collecting pandas
  Using cached pandas-2.3.2-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (91 kB)
Collecting numpy
  Using cached numpy-2.2.6-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (62 kB)
Collecting setuptools>=60.9.0 (from ccxt)
  Using cached setuptools-82.0.0-py3-none-any.whl.metadata (6.6 kB)
Collecting certifi>=2018.1.18 (from ccxt)
  Using cached certifi-2026.1.4-py3-none-any.whl.metadata (2.5 kB)
Collecting cryptography>=2.6.1 (from ccxt)
  Using cached cryptography-46.0.4-cp311-abi3-manylinux2014_x86_64.manylinux_2_17_x86_64.whl.metadata (5.7 kB)
Collecting typing_extensions>=4.4.0 (from ccxt)
  Using cached typing_extensions-4.15.0-py3-none-any.whl.metadata (3.3 kB)
Collecting aiohttp>=3.10.11 (from ccxt)
  Using cached aiohttp-3.13.3-cp312-cp312-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl.metadata (8.1 kB)
Collecting aiodns>=1.1.1 (from ccxt)
  Using cached aiodns-4.0.0-py3-none-any.whl.metadata (7.7 kB)
Collecting yarl>=1.7.2 (from ccxt)
  Using cached yarl-1.22.0-cp312-cp312-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl.metadata (75 kB)
Collecting coincurve==21.0.0 (from ccxt)
  Using cached coincurve-21.0.0-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.0 kB)
Collecting multitasking>=0.0.7 (from yfinance)
  Using cached multitasking-0.0.11-py3-none-any.whl.metadata (5.5 kB)
Collecting platformdirs>=2.0.0 (from yfinance)
  Using cached platformdirs-4.5.1-py3-none-any.whl.metadata (12 kB)
Collecting pytz>=2022.5 (from yfinance)
  Using cached pytz-2025.2-py2.py3-none-any.whl.metadata (22 kB)
Collecting frozendict>=2.3.4 (from yfinance)
  Using cached frozendict-2.4.7-py3-none-any.whl.metadata (23 kB)
Collecting peewee>=3.16.2 (from yfinance)
  Using cached peewee-3.19.0-py3-none-any.whl.metadata (7.0 kB)
Collecting beautifulsoup4>=4.11.1 (from yfinance)
  Using cached beautifulsoup4-4.14.3-py3-none-any.whl.metadata (3.8 kB)
Collecting curl_cffi<0.14,>=0.7 (from yfinance)
  Using cached curl_cffi-0.13.0-cp39-abi3-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (13 kB)
Collecting protobuf>=3.19.0 (from yfinance)
  Using cached protobuf-6.33.5-cp39-abi3-manylinux2014_x86_64.whl.metadata (593 bytes)
Collecting websockets>=13.0 (from yfinance)
  Using cached websockets-16.0-cp312-cp312-manylinux1_x86_64.manylinux_2_28_x86_64.manylinux_2_5_x86_64.whl.metadata (6.8 kB)
Collecting cffi>=1.12.0 (from curl_cffi<0.14,>=0.7->yfinance)
  Using cached cffi-2.0.0-cp312-cp312-manylinux2014_x86_64.manylinux_2_17_x86_64.whl.metadata (2.6 kB)
Collecting charset_normalizer<4,>=2 (from requests)
  Using cached charset_normalizer-3.4.4-cp312-cp312-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl.metadata (37 kB)
Collecting idna<4,>=2.5 (from requests)
  Using cached idna-3.11-py3-none-any.whl.metadata (8.4 kB)
Collecting urllib3<3,>=1.21.1 (from requests)
  Using cached urllib3-2.6.3-py3-none-any.whl.metadata (6.9 kB)
Collecting python-dateutil>=2.8.2 (from pandas)
  Using cached python_dateutil-2.9.0.post0-py2.py3-none-any.whl.metadata (8.4 kB)
Collecting tzdata>=2022.7 (from pandas)
  Using cached tzdata-2025.3-py2.py3-none-any.whl.metadata (1.4 kB)
INFO: pip is looking at multiple versions of aiodns to determine which version is compatible with other requirements. This could take a while.
Collecting aiodns>=1.1.1 (from ccxt)
  Using cached aiodns-3.6.1-py3-none-any.whl.metadata (5.8 kB)
Collecting pycares<5,>=4.9.0 (from aiodns>=1.1.1->ccxt)
  Using cached pycares-4.9.0-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.3 kB)
Collecting aiohappyeyeballs>=2.5.0 (from aiohttp>=3.10.11->ccxt)
  Using cached aiohappyeyeballs-2.6.1-py3-none-any.whl.metadata (5.9 kB)
Collecting aiosignal>=1.4.0 (from aiohttp>=3.10.11->ccxt)
  Using cached aiosignal-1.4.0-py3-none-any.whl.metadata (3.7 kB)
Collecting attrs>=17.3.0 (from aiohttp>=3.10.11->ccxt)
  Using cached attrs-25.4.0-py3-none-any.whl.metadata (10 kB)
Collecting frozenlist>=1.1.1 (from aiohttp>=3.10.11->ccxt)
  Using cached frozenlist-1.8.0-cp312-cp312-manylinux1_x86_64.manylinux_2_28_x86_64.manylinux_2_5_x86_64.whl.metadata (20 kB)
Collecting multidict<7.0,>=4.5 (from aiohttp>=3.10.11->ccxt)
  Using cached multidict-6.7.1-cp312-cp312-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl.metadata (5.3 kB)
Collecting propcache>=0.2.0 (from aiohttp>=3.10.11->ccxt)
  Using cached propcache-0.4.1-cp312-cp312-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl.metadata (13 kB)
Collecting soupsieve>=1.6.1 (from beautifulsoup4>=4.11.1->yfinance)
  Using cached soupsieve-2.8.3-py3-none-any.whl.metadata (4.6 kB)
Collecting pycparser (from cffi>=1.12.0->curl_cffi<0.14,>=0.7->yfinance)
  Using cached pycparser-3.0-py3-none-any.whl.metadata (8.2 kB)
Collecting six>=1.5 (from python-dateutil>=2.8.2->pandas)
  Using cached six-1.17.0-py2.py3-none-any.whl.metadata (1.7 kB)
Using cached ccxt-4.5.36-py2.py3-none-any.whl (6.4 MB)
Using cached coincurve-21.0.0-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (1.6 MB)
Using cached yfinance-1.1.0-py2.py3-none-any.whl (129 kB)
Using cached curl_cffi-0.13.0-cp39-abi3-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (8.3 MB)
Using cached requests-2.32.5-py3-none-any.whl (64 kB)
Using cached charset_normalizer-3.4.4-cp312-cp312-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl (153 kB)
Using cached idna-3.11-py3-none-any.whl (71 kB)
Using cached urllib3-2.6.3-py3-none-any.whl (131 kB)
Using cached pandas-2.3.2-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (12.0 MB)
Using cached numpy-2.2.6-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (16.5 MB)
Using cached aiodns-3.6.1-py3-none-any.whl (8.0 kB)
Using cached pycares-4.9.0-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (629 kB)
Using cached aiohttp-3.13.3-cp312-cp312-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl (1.8 MB)
Using cached multidict-6.7.1-cp312-cp312-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl (256 kB)
Using cached yarl-1.22.0-cp312-cp312-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl (377 kB)
Using cached aiohappyeyeballs-2.6.1-py3-none-any.whl (15 kB)
Using cached aiosignal-1.4.0-py3-none-any.whl (7.5 kB)
Using cached attrs-25.4.0-py3-none-any.whl (67 kB)
Using cached beautifulsoup4-4.14.3-py3-none-any.whl (107 kB)
Using cached certifi-2026.1.4-py3-none-any.whl (152 kB)
Using cached cffi-2.0.0-cp312-cp312-manylinux2014_x86_64.manylinux_2_17_x86_64.whl (219 kB)
Using cached cryptography-46.0.4-cp311-abi3-manylinux2014_x86_64.manylinux_2_17_x86_64.whl (4.4 MB)
Using cached frozendict-2.4.7-py3-none-any.whl (16 kB)
Using cached frozenlist-1.8.0-cp312-cp312-manylinux1_x86_64.manylinux_2_28_x86_64.manylinux_2_5_x86_64.whl (242 kB)
Using cached multitasking-0.0.11-py3-none-any.whl (8.5 kB)
Using cached peewee-3.19.0-py3-none-any.whl (411 kB)
Using cached platformdirs-4.5.1-py3-none-any.whl (18 kB)
Using cached propcache-0.4.1-cp312-cp312-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl (221 kB)
Using cached protobuf-6.33.5-cp39-abi3-manylinux2014_x86_64.whl (323 kB)
Using cached python_dateutil-2.9.0.post0-py2.py3-none-any.whl (229 kB)
Using cached pytz-2025.2-py2.py3-none-any.whl (509 kB)
Using cached setuptools-82.0.0-py3-none-any.whl (1.0 MB)
Using cached six-1.17.0-py2.py3-none-any.whl (11 kB)
Using cached soupsieve-2.8.3-py3-none-any.whl (37 kB)
Using cached typing_extensions-4.15.0-py3-none-any.whl (44 kB)
Using cached tzdata-2025.3-py2.py3-none-any.whl (348 kB)
Using cached websockets-16.0-cp312-cp312-manylinux1_x86_64.manylinux_2_28_x86_64.manylinux_2_5_x86_64.whl (184 kB)
Using cached pycparser-3.0-py3-none-any.whl (48 kB)
Installing collected packages: pytz, peewee, multitasking, websockets, urllib3, tzdata, typing_extensions, soupsieve, six, setuptools, pycparser, protobuf, propcache, platformdirs, numpy, multidict, idna, frozenlist, frozendict, coincurve, charset_normalizer, certifi, attrs, aiohappyeyeballs, yarl, requests, python-dateutil, cffi, beautifulsoup4, aiosignal, pycares, pandas, curl_cffi, cryptography, aiohttp, yfinance, aiodns, ccxt

ERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.
tensorflow 2.16.2 requires numpy<2.0.0,>=1.26.0; python_version >= "3.12", but you have numpy 2.2.6 which is incompatible.
tensorflow 2.16.2 requires protobuf!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<5.0.0dev,>=3.20.3, but you have protobuf 6.33.5 which is incompatible.
matplotlib 3.8.2 requires numpy<2,>=1.21, but you have numpy 2.2.6 which is incompatible.
Successfully installed aiodns-3.6.1 aiohappyeyeballs-2.6.1 aiohttp-3.13.3 aiosignal-1.4.0 attrs-25.4.0 beautifulsoup4-4.14.3 ccxt-4.5.36 certifi-2026.1.4 cffi-2.0.0 charset_normalizer-3.4.4 coincurve-21.0.0 cryptography-46.0.4 curl_cffi-0.13.0 frozendict-2.4.7 frozenlist-1.8.0 idna-3.11 multidict-6.7.1 multitasking-0.0.11 numpy-2.2.6 pandas-2.3.2 peewee-3.19.0 platformdirs-4.5.1 propcache-0.4.1 protobuf-6.33.5 pycares-4.9.0 pycparser-3.0 python-dateutil-2.9.0.post0 pytz-2025.2 requests-2.32.5 setuptools-82.0.0 six-1.17.0 soupsieve-2.8.3 typing_extensions-4.15.0 tzdata-2025.3 urllib3-2.6.3 websockets-16.0 yarl-1.22.0 yfinance-1.1.0

[notice] A new release of pip is available: 25.3 -> 26.0.1
[notice] To update, run: python3 -m pip install --upgrade pip
  ‚Üí Optimizing CCXT size...
[0;32m‚úÖ Layer prepared in lambda/layer[0m

‚öôÔ∏è  Step 3: Configuring CDK App...
----------------------------------------------------------------------
[0;32m‚úÖ Account ID updated: 946179054632[0m

üîß Step 4: CDK Bootstrap...
----------------------------------------------------------------------
[1;33m‚ö†Ô∏è  CDK already bootstrapped[0m

üîç Step 5: Validating CDK Stack...
----------------------------------------------------------------------
[WARNING] aws-cdk-lib.aws_dynamodb.TableOptions#pointInTimeRecovery is deprecated.
  use `pointInTimeRecoverySpecification` instead
  This API will be removed in the next major release.
[WARNING] aws-cdk-lib.aws_dynamodb.TableOptions#pointInTimeRecovery is deprecated.
  use `pointInTimeRecoverySpecification` instead
  This API will be removed in the next major release.
[WARNING] aws-cdk-lib.aws_lambda.FunctionOptions#logRetention is deprecated.
  use `logGroup` instead
  This API will be removed in the next major release.
[WARNING] aws-cdk-lib.aws_dynamodb.TableOptions#pointInTimeRecovery is deprecated.
  use `pointInTimeRecoverySpecification` instead
  This API will be removed in the next major release.
[WARNING] aws-cdk-lib.aws_dynamodb.TableOptions#pointInTimeRecovery is deprecated.
  use `pointInTimeRecoverySpecification` instead
  This API will be removed in the next major release.
[WARNING] aws-cdk-lib.aws_dynamodb.TableOptions#pointInTimeRecovery is deprecated.
  use `pointInTimeRecoverySpecification` instead
  This API will be removed in the next major release.
[WARNING] aws-cdk-lib.aws_dynamodb.TableOptions#pointInTimeRecovery is deprecated.
  use `pointInTimeRecoverySpecification` instead
  This API will be removed in the next major release.
[WARNING] aws-cdk-lib.aws_lambda.FunctionOptions#logRetention is deprecated.
  use `logGroup` instead
  This API will be removed in the next major release.
74 feature flags are not configured. Run 'cdk flags --unstable=flags' to learn more.

NOTICES         (What's this? https://github.com/aws/aws-cdk/wiki/CLI-Notices)

34892	CDK CLI collects telemetry data on command usage starting at version 2.1100.0 (unless opted out)

	Overview: We do not collect customer content and we anonymize the
	          telemetry we do collect. See the attached issue for more
	          information on what data is collected, why, and how to
	          opt-out. Telemetry will NOT be collected for any CDK CLI
	          version prior to version 2.1100.0 - regardless of
	          opt-in/out. You can also view the telemetry we collect by
	          logging it to a local file, by adding
	          `--telemetry-file=my/local/file` to any `cdk` command.

	Affected versions: cli: ^2.1100.0

	More information at: https://github.com/aws/aws-cdk/issues/34892


If you don‚Äôt want to see a notice anymore, use "cdk acknowledge <id>". For example, "cdk acknowledge 34892".
[0;32m‚úÖ Stack validated[0m

üöÄ Step 6: Deploying to AWS...
----------------------------------------------------------------------
[1;33m‚ö†Ô∏è  This will create AWS resources (Lambda, DynamoDB, EventBridge)[0m

Deploying... (this may take 2-3 minutes)
[WARNING] aws-cdk-lib.aws_dynamodb.TableOptions#pointInTimeRecovery is deprecated.
  use `pointInTimeRecoverySpecification` instead
  This API will be removed in the next major release.
[WARNING] aws-cdk-lib.aws_dynamodb.TableOptions#pointInTimeRecovery is deprecated.
  use `pointInTimeRecoverySpecification` instead
  This API will be removed in the next major release.
[WARNING] aws-cdk-lib.aws_lambda.FunctionOptions#logRetention is deprecated.
  use `logGroup` instead
  This API will be removed in the next major release.
[WARNING] aws-cdk-lib.aws_dynamodb.TableOptions#pointInTimeRecovery is deprecated.
  use `pointInTimeRecoverySpecification` instead
  This API will be removed in the next major release.
[WARNING] aws-cdk-lib.aws_dynamodb.TableOptions#pointInTimeRecovery is deprecated.
  use `pointInTimeRecoverySpecification` instead
  This API will be removed in the next major release.
[WARNING] aws-cdk-lib.aws_dynamodb.TableOptions#pointInTimeRecovery is deprecated.
  use `pointInTimeRecoverySpecification` instead
  This API will be removed in the next major release.
[WARNING] aws-cdk-lib.aws_dynamodb.TableOptions#pointInTimeRecovery is deprecated.
  use `pointInTimeRecoverySpecification` instead
  This API will be removed in the next major release.
[WARNING] aws-cdk-lib.aws_lambda.FunctionOptions#logRetention is deprecated.
  use `logGroup` instead
  This API will be removed in the next major release.

‚ú®  Synthesis time: 68.56s

V4TradingStack: start: Building V4TradingStack Template
V4TradingStack: success: Built V4TradingStack Template
V4TradingStack: start: Publishing V4TradingStack Template (946179054632-eu-west-3-56fd4443)
V4TradingStack: success: Published V4TradingStack Template (946179054632-eu-west-3-56fd4443)
V4TradingStack: deploying... [1/1]
V4TradingStack: creating CloudFormation changeset...
V4TradingStack | 0/5 | 11:58:28 PM | UPDATE_IN_PROGRESS   | AWS::CloudFormation::Stack | V4TradingStack User Initiated
V4TradingStack | 0/5 | 11:58:32 PM | UPDATE_IN_PROGRESS   | AWS::Lambda::Function      | V4StatusReporter (V4StatusReporter54F18DF8) 
V4TradingStack | 1/5 | 11:58:40 PM | UPDATE_COMPLETE      | AWS::Lambda::Function      | V4StatusReporter (V4StatusReporter54F18DF8) 
V4TradingStack | 2/5 | 11:58:42 PM | UPDATE_COMPLETE_CLEA | AWS::CloudFormation::Stack | V4TradingStack 
V4TradingStack | 3/5 | 11:58:43 PM | UPDATE_COMPLETE      | AWS::CloudFormation::Stack | V4TradingStack 

 ‚úÖ  V4TradingStack

‚ú®  Deployment time: 27.48s

Outputs:
V4TradingStack.HistoryTableName = V4TradeHistory
V4TradingStack.ManualTriggerArn = arn:aws:lambda:eu-west-3:946179054632:function:V4ManualTrigger
V4TradingStack.ScheduleRuleName = V4HybridHourlyCron
V4TradingStack.StateTableName = V4TradingState
V4TradingStack.TradingLambdaArn = arn:aws:lambda:eu-west-3:946179054632:function:V4HybridLiveTrader
Stack ARN:
arn:aws:cloudformation:eu-west-3:946179054632:stack/V4TradingStack/4e1368d0-0112-11f1-9f17-06f693d15df1

‚ú®  Total time: 96.04s


NOTICES         (What's this? https://github.com/aws/aws-cdk/wiki/CLI-Notices)

34892	CDK CLI collects telemetry data on command usage starting at version 2.1100.0 (unless opted out)

	Overview: We do not collect customer content and we anonymize the
	          telemetry we do collect. See the attached issue for more
	          information on what data is collected, why, and how to
	          opt-out. Telemetry will NOT be collected for any CDK CLI
	          version prior to version 2.1100.0 - regardless of
	          opt-in/out. You can also view the telemetry we collect by
	          logging it to a local file, by adding
	          `--telemetry-file=my/local/file` to any `cdk` command.

	Affected versions: cli: ^2.1100.0

	More information at: https://github.com/aws/aws-cdk/issues/34892


If you don‚Äôt want to see a notice anymore, use "cdk acknowledge <id>". For example, "cdk acknowledge 34892".

[0;32m‚úÖ Deployment Complete![0m

üîé Step 7: Verifying Deployment...
----------------------------------------------------------------------
[0;31m‚ùå Lambda not found[0m
[0;32m‚úÖ DynamoDB State Table: V4TradingState[0m
[0;31m‚ùå EventBridge rule not found[0m

üß™ Step 8: Testing Lambda...
----------------------------------------------------------------------

======================================================================
‚úÖ DEPLOYMENT SUCCESSFUL!
======================================================================

üìã Resources Created:
  - Lambda: 
  - DynamoDB: V4TradingState
  - EventBridge: None (runs hourly)

üéØ Next Steps:
  1. Monitor CloudWatch Logs:
     aws logs tail /aws/lambda/ --follow

  2. Check DynamoDB State:
     aws dynamodb scan --table-name V4TradingState

  3. View EventBridge Schedule:
     aws events describe-rule --name None

  4. To change to LIVE mode:
     aws lambda update-function-configuration \
       --function-name  \
       --environment Variables={TRADING_MODE=live}

‚ö†Ô∏è  Currently in TEST MODE - no real trades will be executed

üìñ Full guide: DEPLOYMENT_GUIDE.md
======================================================================
